<!doctype html>
<html lang="en" class="h-full">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>THE TURNING POINT - OUTBREAK ARCHIVE</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=VT323&amp;family=Courier+Prime:wght@400;700&amp;display=swap"
    rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Courier Prime', monospace;
      background: #0a0a0a;
      color: #ff3333;
      overflow: hidden;
    }

    .font-retro {
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
    }

    /* CRT Scan Effects */
    .crt-scanlines {
      pointer-events: none;
      position: fixed;
      inset: 0;
      background: repeating-linear-gradient(0deg,
          rgba(255, 0, 0, 0.03),
          rgba(255, 0, 0, 0.03) 1px,
          transparent 1px,
          transparent 2px);
      z-index: 999;
    }

    .crt-flicker {
      animation: flicker 0.15s infinite;
    }

    @keyframes flicker {

      0%,
      100% {
        opacity: 0.98;
      }

      50% {
        opacity: 1;
      }
    }

    /* Blood splatter background */
    .blood-bg {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 800px 600px at 20% 30%, rgba(139, 0, 0, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse 600px 700px at 80% 70%, rgba(100, 0, 0, 0.1) 0%, transparent 50%),
        radial-gradient(ellipse 500px 500px at 50% 50%, rgba(80, 0, 0, 0.08) 0%, transparent 50%);
      z-index: 0;
    }

    /* Biohazard Warning */
    .biohazard-warning {
      position: fixed;
      top: 16px;
      right: 16px;
      background: radial-gradient(circle, #ff4444, #cc0000);
      border: 3px solid #ff8800;
      padding: 12px 16px;
      border-radius: 50%;
      font-weight: bold;
      animation: warning-pulse 1s infinite;
      z-index: 100;
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 0 30px rgba(255, 0, 0, 0.8), inset 0 0 15px rgba(0, 0, 0, 0.5);
    }

    @keyframes warning-pulse {

      0%,
      100% {
        transform: scale(1);
        box-shadow: 0 0 30px rgba(255, 0, 0, 0.8), inset 0 0 15px rgba(0, 0, 0, 0.5);
      }

      50% {
        transform: scale(1.05);
        box-shadow: 0 0 50px rgba(255, 0, 0, 1), inset 0 0 20px rgba(0, 0, 0, 0.7);
      }
    }

    /* Gore-stained text */
    .gore-text {
      text-shadow:
        2px 2px 0 rgba(139, 0, 0, 0.8),
        4px 4px 0 rgba(80, 0, 0, 0.6),
        6px 6px 8px rgba(0, 0, 0, 0.9);
      color: #ff4444;
    }

    /* Infection stages */
    .stage-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      border: 3px solid;
      position: relative;
      overflow: hidden;
      animation: stage-throb 1.5s infinite;
    }

    .stage-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .stage-runner {
      border-color: #ffd700;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
    }

    .stage-stalker {
      border-color: #ff9800;
      box-shadow: 0 0 20px rgba(255, 152, 0, 0.5);
    }

    .stage-clicker {
      border-color: #ff5722;
      box-shadow: 0 0 20px rgba(255, 87, 34, 0.5);
    }

    .stage-bloater {
      border-color: #8b0000;
      box-shadow: 0 0 30px rgba(139, 0, 0, 0.8);
    }

    @keyframes stage-throb {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.08);
      }
    }

    /* Decayed panels */
    .panel-gore {
      background: linear-gradient(135deg, #1a0a0a 0%, #0d0505 100%);
      border: 2px solid #8b2020;
      position: relative;
      overflow: hidden;
    }

    .panel-gore::before {
      content: '';
      position: absolute;
      inset: 0;
      background:
        repeating-linear-gradient(45deg, transparent, transparent 2px, rgba(139, 0, 0, 0.1) 2px, rgba(139, 0, 0, 0.1) 4px);
      pointer-events: none;
    }

    .panel-header-gore {
      background: linear-gradient(90deg, rgba(139, 0, 0, 0.3) 0%, transparent 100%);
      border-bottom: 2px solid #8b2020;
      padding: 12px 16px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #ff6666;
      font-family: 'VT323', monospace;
    }

    /* Buttons */
    .btn-infected {
      background: linear-gradient(135deg, #8b0000 0%, #4d0000 100%);
      border: 2px solid #ff3333;
      color: #ff9999;
      padding: 12px 24px;
      font-family: 'VT323', monospace;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(255, 51, 51, 0.3);
    }

    .btn-infected:hover {
      background: linear-gradient(135deg, #cc0000 0%, #8b0000 100%);
      box-shadow: 0 0 25px rgba(255, 51, 51, 0.7);
      transform: translateY(-2px);
    }

    .btn-infected:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Form inputs */
    .input-infected {
      background: #0a0a0a;
      border: 2px solid #8b2020;
      color: #ff3333;
      padding: 12px 16px;
      font-family: 'Courier Prime', monospace;
      font-size: 1rem;
      width: 100%;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .input-infected:focus {
      outline: none;
      border-color: #ff3333;
      box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
      background: rgba(139, 0, 0, 0.05);
    }

    .input-infected::placeholder {
      color: #663333;
    }

    .select-infected {
      background: #0a0a0a url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23ff3333' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10l-5 5z'/%3E%3C/svg%3E") no-repeat right 12px center;
      background-size: 12px;
      appearance: none;
      padding-right: 36px;
    }

    /* Map */
    .map-container {
      background: linear-gradient(180deg, #0d1a0d 0%, #0a0f0a 100%);
      border: 3px solid #8b2020;
      position: relative;
      overflow: hidden;
      height: 300px;
    }

    .map-grid {
      position: absolute;
      inset: 0;
      background-image: url('https://images.unsplash.com/photo-1524661135-423995f22d0b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80');
      background-repeat: no-repeat;
      background-size: cover;
      opacity: 0.5;
    }

    .zone-marker {
      position: absolute;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      border: 2px solid;
    }

    .zone-marker:hover {
      transform: scale(1.4);
      z-index: 100;
    }

    .marker-safe {
      background: radial-gradient(circle, #4caf50, #1b5e20);
      border-color: #81c784;
      box-shadow: 0 0 20px rgba(76, 175, 80, 0.6);
    }

    .marker-danger {
      background: radial-gradient(circle, #ff0000, #8b0000);
      border-color: #ff3333;
      box-shadow: 0 0 25px rgba(255, 0, 0, 0.8);
      animation: danger-pulse 0.7s infinite;
    }

    @keyframes danger-pulse {

      0%,
      100% {
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
      }

      50% {
        box-shadow: 0 0 35px rgba(255, 0, 0, 1);
      }
    }

    /* Modal */
    .calibration-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      backdrop-filter: blur(10px);
    }

    .calibration-container {
      background: linear-gradient(135deg, #1a0a0a 0%, #0d0505 100%);
      border: 4px solid #ff3333;
      border-radius: 8px;
      padding: 32px;
      max-width: 600px;
      width: 90%;
      box-shadow: 0 0 50px rgba(139, 0, 0, 0.8);
    }

    .calibration-title {
      font-family: 'VT323', monospace;
      font-size: 2rem;
      font-weight: bold;
      color: #ff4444;
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow: 0 0 10px rgba(255, 0, 0, 0.6);
      margin-bottom: 24px;
    }

    /* Inventory Modal */
    #inventory-modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }

    #inventory-modal:not(.hidden) {
      display: flex;
    }

    .modal-content {
      background: linear-gradient(135deg, #1a0a0a 0%, #0d0505 100%);
      border: 4px solid #ff3333;
      border-radius: 8px;
      padding: 32px;
      max-width: 500px;
      width: 90%;
    }

    .modal-content h3 {
      font-family: 'VT323', monospace;
      font-size: 1.8rem;
      color: #ff4444;
      margin-bottom: 24px;
    }

    .modal-content label {
      display: block;
      color: #ff6666;
      font-family: 'VT323', monospace;
      font-size: 1.2rem;
      margin-bottom: 8px;
    }

    .modal-content input {
      width: 100%;
      padding: 10px;
      margin-bottom: 16px;
      background: #0a0a0a;
      border: 2px solid #8b2020;
      color: #ff3333;
      font-family: 'Courier Prime', monospace;
    }

    /* Music Control */
    .music-control {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1001;
      background: rgba(10, 15, 10, 0.8);
      border: 2px solid #8b2020;
      border-radius: 50px;
      padding: 8px 16px;
      color: #d4e6d4;
      font-family: 'VT323', monospace;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }

    .music-control:hover {
      background: rgba(139, 32, 32, 0.3);
      border-color: #ff4444;
      transform: scale(1.05);
    }

    .music-control.playing {
      border-color: #4caf50;
      box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
    }

    /* Clock Styles */
    .clock-container {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 1001;
      background: rgba(10, 15, 10, 0.8);
      border: 2px solid #8b2020;
      border-radius: 8px;
      padding: 12px 20px;
      font-family: 'VT323', monospace;
      backdrop-filter: blur(5px);
      box-shadow: 0 0 20px rgba(139, 0, 0, 0.3);
      text-align: center;
      transition: opacity 0.3s ease;
    }

    .clock-time {
      font-size: 2rem;
      font-weight: bold;
      color: #ff4444;
      text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
      letter-spacing: 3px;
      line-height: 1;
    }

    .clock-date {
      font-size: 1rem;
      color: #ff6666;
      margin-top: 4px;
      letter-spacing: 1px;
    }

    .clock-label {
      font-size: 0.8rem;
      color: #8b2020;
      text-transform: uppercase;
      margin-top: 2px;
    }

    /* Hidden class */
    .hidden {
      display: none !important;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: #0a0a0a;
    }

    ::-webkit-scrollbar-thumb {
      background: #8b2020;
      border-radius: 5px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #ff3333;
    }

    /* Content wrapper */
    .content-wrapper {
      position: relative;
      z-index: 1;
      height: 100vh;
      overflow-y: auto;
    }
  </style>
</head>

<body class="h-full overflow-hidden crt-flicker">
  <!-- Audio element for music -->
  <audio id="dark-music" loop preload="auto">
    <source src="dark.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- Music Control Button -->
  <div class="music-control playing" id="musicControl" onclick="toggleMusic()">
    <span id="musicIcon">üîä</span>
    <span id="musicStatus">Playing</span>
  </div>

  <!-- IST Clock Display (visible only on landing page) -->
  <div class="clock-container" id="ist-clock">
    <div class="clock-time" id="clock-time">23:04:11</div>
    <div class="clock-date" id="clock-date">2024-01-15</div>
    <div class="clock-label">INDIAN STANDARD TIME</div>
  </div>

  <div class="crt-scanlines"></div>
  <div class="blood-bg"></div>
  <div class="biohazard-warning">‚ö†Ô∏è</div>

  <div id="app" class="min-h-full w-full content-wrapper">
    <!-- LANDING PAGE -->
    <div id="landing-page" class="min-h-full w-full">
      <div class="py-16 px-4 text-center">
        <div class="mb-8 pt-8">
          <p class="text-sm tracking-widest text-red-500 mb-4 gore-text font-retro">‚ñì‚ñì‚ñì WARNING: BIOHAZARD DETECTED ‚ñì‚ñì‚ñì
          </p>
          <h1 id="terminal-title" class="font-retro text-6xl md:text-7xl font-black mb-4 gore-text">THE TURNING POINT
          </h1>
          <p id="terminal-msg" class="text-red-600 text-lg md:text-xl mt-4 tracking-wider font-retro">OUTBREAK IN
            PROGRESS ‚Äî ACCESS RESTRICTED</p>
        </div>

        <div class="inline-block px-8 py-4 bg-red-950/40 border-4 border-red-700 mb-12">
          <p class="text-red-500 font-retro text-lg tracking-widest">INFECTION RATE: EXPONENTIAL</p>
        </div>

        <div class="max-w-4xl mx-auto mb-12">
          <h2 class="font-retro text-2xl md:text-3xl text-red-500 mb-6">CORDYCEPS INFECTION STAGES</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="panel-gore p-6 rounded-lg text-center">
              <div class="stage-icon stage-runner mb-4 mx-auto">
                <img src="runner.jpeg" alt="runner">
              </div>
              <h3 class="font-retro text-lg text-yellow-400 mb-2">RUNNER</h3>
              <p class="text-red-600 text-xs leading-relaxed">Hours 1-2. Still appears human. Highly aggressive.
                Unstable CNS.</p>
            </div>
            <div class="panel-gore p-6 rounded-lg text-center">
              <div class="stage-icon stage-stalker mb-4 mx-auto">
                <img src="stalker.jpeg" alt="Stalker">
              </div>
              <h3 class="font-retro text-lg text-orange-400 mb-2">STALKER</h3>
              <p class="text-red-600 text-xs leading-relaxed">Week 2-4. Fungal nodules emerging. Predatory tactics.
                Coordinated hunting.</p>
            </div>
            <div class="panel-gore p-6 rounded-lg text-center">
              <div class="stage-icon stage-clicker mb-4 mx-auto">
                <img src="clicker.jpeg" alt="Clicker">
              </div>
              <h3 class="font-retro text-lg text-orange-600 mb-2">CLICKER</h3>
              <p class="text-red-600 text-xs leading-relaxed">Year 1+. Complete blindness. Echolocation. Hardened shell.
                EXTREME DANGER.</p>
            </div>
            <div class="panel-gore p-6 rounded-lg text-center">
              <div class="stage-icon stage-bloater mb-4 mx-auto">
                <img src="bloater.webp" alt="Bloater">
              </div>
              <h3 class="font-retro text-lg text-red-700 mb-2">BLOATER</h3>
              <p class="text-red-600 text-xs leading-relaxed">Years 10+. Massive fungal body. Spore delivery system.
                CANNOT BE KILLED.</p>
            </div>
          </div>
        </div>

        <!-- ENTER BUTTON - Direct to Symptom Assessment -->
        <div class="max-w-2xl mx-auto mt-8">
          <button onclick="showSymptomAssessment()" class="btn-infected w-full py-4 px-12 text-xl">
            BEGIN ASSESSMENT ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- SYMPTOM ASSESSMENT MODAL -->
    <div id="symptom-modal" class="calibration-backdrop hidden">
      <div class="calibration-container">
        <div class="calibration-title">‚ò£Ô∏è SYMPTOM ASSESSMENT</div>

        <div class="space-y-5 text-red-400 font-retro text-lg">
          <div>
            <label class="block mb-2">1. Fever level?</label>
            <select id="sym-fever" class="input-infected rounded w-full">
              <option value="0">None - Normal temperature</option>
              <option value="10">Mild - Slight warmth</option>
              <option value="20">High - Severe fever</option>
            </select>
          </div>

          <div>
            <label class="block mb-2">2. Aggression / Irritability?</label>
            <select id="sym-aggression" class="input-infected rounded w-full">
              <option value="0">Normal - Calm</option>
              <option value="10">Irritable - Easily agitated</option>
              <option value="20">Violent - Uncontrollable rage</option>
            </select>
          </div>

          <div>
            <label class="block mb-2">3. Vision disturbance?</label>
            <select id="sym-vision" class="input-infected rounded w-full">
              <option value="0">Clear - Normal vision</option>
              <option value="10">Blurred - Difficulty focusing</option>
              <option value="20">Severe - Almost blind</option>
            </select>
          </div>

          <div>
            <label class="block mb-2">4. Fungal skin growth?</label>
            <select id="sym-fungus" class="input-infected rounded w-full">
              <option value="0">None - Clean skin</option>
              <option value="15">Minor - Small patches</option>
              <option value="30">Advanced - Extensive growth</option>
            </select>
          </div>

          <div>
            <label class="block mb-2">5. Current Sector?</label>
            <select id="user-sector" class="input-infected rounded w-full">
              <option value="Sector 1 - Downtown">Sector 1 - Downtown Quarantine</option>
              <option value="Sector 2 - Harbor">Sector 2 - Harbor District</option>
              <option value="Sector 3 - Industrial">Sector 3 - Industrial Zone</option>
              <option value="Sector 4 - Residential">Sector 4 - Residential North</option>
              <option value="Sector 5 - University">Sector 5 - University Campus</option>
              <option value="Sector 6 - Old Town">Sector 6 - Old Town</option>
              <option value="Sector 7 - Outskirts">Sector 7 - Outskirts</option>
            </select>
          </div>
        </div>

        <button id="submit-symptoms" class="btn-infected w-full mt-8 rounded text-lg py-4">
          ANALYZE BIOMETRICS
        </button>
      </div>
    </div>

    <!-- COMMAND CENTER (Main Interface) -->
    <div id="command-center" class="hidden min-h-full w-full p-4 md:p-6">
      <!-- Header -->
      <div class="panel-gore mb-6 rounded-lg p-4">
        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
          <div class="flex items-center gap-4">
            <div
              class="w-14 h-14 rounded-lg flex items-center justify-center text-3xl border-2 border-red-500 bg-red-900/30">
              üß¨
            </div>
            <div>
              <h1 class="font-retro text-xl text-red-500" id="user-sector-display">SECTOR UNKNOWN</h1>
              <p class="text-red-700 text-sm font-retro" id="user-status">OPERATIVE</p>
            </div>
          </div>
          <div class="text-right">
            <p class="text-red-700 text-xs font-retro">INFECTION STAGE</p>
            <p class="font-retro text-red-400" id="infection-stage-display">UNINFECTED</p>
          </div>
          <button id="logout-btn"
            class="px-6 py-2 bg-red-950 border-2 border-red-700 rounded text-red-400 hover:bg-red-900 transition-all text-sm font-retro">DISCONNECT</button>
        </div>
      </div>

      <!-- Main Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Left Column - Biometrics -->
        <div class="space-y-6">
          <!-- Full Biometric Profile -->
          <div class="panel-gore rounded-lg overflow-hidden">
            <div class="panel-header-gore">üß¨ FULL BIOMETRIC PROFILE</div>
            <div class="p-4">
              <div class="grid grid-cols-1 gap-4 text-red-400 font-retro text-lg">
                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">BLOOD PRESSURE</div>
                  <div id="bio-bp">120 / 80</div>
                </div>

                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">BLOOD INFECTION</div>
                  <div id="bio-infection">0%</div>
                </div>

                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">BLOOD SUGAR</div>
                  <div id="bio-sugar">95 mg/dL</div>
                </div>

                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">BODY HYDRATION</div>
                  <div id="bio-water">75%</div>
                </div>

                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">HEART RATE</div>
                  <div id="bio-heart">72 BPM</div>
                </div>

                <div class="panel-gore p-3 rounded">
                  <div class="text-red-600 text-sm">OXYGEN LEVEL</div>
                  <div id="bio-oxygen">98%</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Center Column -->
        <div class="lg:col-span-2 space-y-6">
          <!-- Health Status Bar -->
          <div class="panel-gore rounded-lg overflow-hidden">
            <div class="panel-header-gore">‚ù§Ô∏è HEALTH MONITOR</div>
            <div class="p-4">
              <div class="mb-4">
                <div class="flex justify-between text-sm mb-2">
                  <span class="text-red-600">HEALTH LEVEL</span>
                  <span class="text-red-400 font-retro" id="health-pct">85%</span>
                </div>
                <div class="w-full h-8 bg-black/50 border-2 border-red-700 rounded overflow-hidden">
                  <div class="h-full bg-gradient-to-r from-green-600 via-yellow-600 to-red-600" id="health-bar"
                    style="width: 85%;"></div>
                </div>
              </div>

              <div class="grid grid-cols-2 gap-4 mt-4">
                <div class="bg-black/40 p-3 rounded border border-red-900/50">
                  <div class="text-red-600 text-sm">INFECTION STAGE</div>
                  <div class="font-retro text-orange-400 text-xl" id="infection-stage-detail">UNINFECTED</div>
                </div>
                <div class="bg-black/40 p-3 rounded border border-red-900/50">
                  <div class="text-red-600 text-sm">SECTOR</div>
                  <div class="font-retro text-blue-400 text-xl" id="sector-detail">UNKNOWN</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Inventory Management -->
          <div class="panel-gore rounded-lg overflow-hidden">
            <div class="panel-header-gore">üéí INVENTORY</div>
            <div class="p-4">
              <div class="grid grid-cols-2 gap-4">
                <div class="flex justify-between items-center p-3 bg-black/30 rounded border border-red-900/50">
                  <span class="text-red-500">Medkits</span>
                  <span class="font-retro text-red-400 text-xl" id="inv-medkits">3</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-black/30 rounded border border-red-900/50">
                  <span class="text-red-500">Ammo</span>
                  <span class="font-retro text-red-400 text-xl" id="inv-ammo">24</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-black/30 rounded border border-red-900/50">
                  <span class="text-red-500">Rags</span>
                  <span class="font-retro text-red-400 text-xl" id="inv-rags">8</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-black/30 rounded border border-red-900/50">
                  <span class="text-red-500">Alcohol</span>
                  <span class="font-retro text-red-400 text-xl" id="inv-alcohol">5</span>
                </div>
                <div
                  class="flex justify-between items-center p-3 bg-black/30 rounded border border-red-900/50 col-span-2">
                  <span class="text-red-500">Trading Cards</span>
                  <span class="font-retro text-yellow-500 text-xl" id="inv-cards">12</span>
                </div>
              </div>

              <button id="update-inventory-btn" class="btn-infected w-full mt-4 rounded">
                UPDATE INVENTORY
              </button>
            </div>
          </div>

          <!-- Tactical Map -->
          <div class="panel-gore rounded-lg overflow-hidden">
            <div class="panel-header-gore">üó∫Ô∏è TACTICAL MAP</div>
            <div class="map-container" id="tactical-map">
              <div class="map-grid"></div>
              <div id="markers-layer"></div>
            </div>
          </div>
          <!-- End of Tactical Map -->

        </div>
      </div>
    </div>

    <!-- INVENTORY UPDATE MODAL -->
    <div id="inventory-modal" class="hidden">
      <div class="modal-content">
        <h3>üì¶ UPDATE INVENTORY</h3>

        <label>Medkits</label>
        <input id="inv-medkits-input" type="number" min="0" value="3">

        <label>Ammunition</label>
        <input id="inv-ammo-input" type="number" min="0" value="24">

        <label>Rags</label>
        <input id="inv-rags-input" type="number" min="0" value="8">

        <label>Alcohol</label>
        <input id="inv-alcohol-input" type="number" min="0" value="5">

        <label>Trading Cards</label>
        <input id="inv-cards-input" type="number" min="0" value="12">

        <div class="flex gap-4 mt-6">
          <button id="save-inventory-btn" class="btn-infected flex-1">SAVE</button>
          <button id="close-inventory-btn" class="btn-infected flex-1 bg-gray-800">CANCEL</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== IST CLOCK FUNCTION =====
    function updateISTClock() {
      const now = new Date();

      // Convert to IST (UTC+5:30)
      const istTime = new Date(now.getTime() + (5.5 * 60 * 60 * 1000));

      // Format time as HH:MM:SS
      const hours = istTime.getUTCHours().toString().padStart(2, '0');
      const minutes = istTime.getUTCMinutes().toString().padStart(2, '0');
      const seconds = istTime.getUTCSeconds().toString().padStart(2, '0');
      const timeString = `${hours}:${minutes}:${seconds}`;

      // Format date as YYYY-MM-DD
      const year = istTime.getUTCFullYear();
      const month = (istTime.getUTCMonth() + 1).toString().padStart(2, '0');
      const day = istTime.getUTCDate().toString().padStart(2, '0');
      const dateString = `${year}-${month}-${day}`;

      // Update DOM
      document.getElementById('clock-time').textContent = timeString;
      document.getElementById('clock-date').textContent = dateString;
    }

    // Update clock immediately and then every second
    updateISTClock();
    setInterval(updateISTClock, 1000);

    // ===== MUSIC CONTROL =====
    const music = document.getElementById('dark-music');
    const musicControl = document.getElementById('musicControl');
    const musicIcon = document.getElementById('musicIcon');
    const musicStatus = document.getElementById('musicStatus');

    // Function to toggle music
    function toggleMusic() {
      if (music.paused) {
        music.play().catch(() => {
          console.log('Playback failed');
        });
        musicControl.classList.add('playing');
        musicIcon.textContent = 'üîä';
        musicStatus.textContent = 'Playing';
      } else {
        music.pause();
        musicControl.classList.remove('playing');
        musicIcon.textContent = 'üîà';
        musicStatus.textContent = 'Muted';
      }
    }

    // Function to attempt auto-play
    function attemptAutoPlay() {
      music.play().then(() => {
        console.log('Music started automatically');
        musicControl.classList.add('playing');
        musicIcon.textContent = 'üîä';
        musicStatus.textContent = 'Playing';
      }).catch(error => {
        console.log('Auto-play was prevented. Click anywhere to start music.');
        musicControl.classList.remove('playing');
        musicIcon.textContent = 'üîà';
        musicStatus.textContent = 'Click to play';

        // Add one-time click handler to start music on first user interaction
        const startMusicOnInteraction = () => {
          music.play().catch(() => { });
          document.removeEventListener('click', startMusicOnInteraction);
          document.removeEventListener('keydown', startMusicOnInteraction);
          document.removeEventListener('touchstart', startMusicOnInteraction);
        };

        document.addEventListener('click', startMusicOnInteraction);
        document.addEventListener('keydown', startMusicOnInteraction);
        document.addEventListener('touchstart', startMusicOnInteraction);
      });
    }

    // Try to auto-play when page loads
    document.addEventListener('DOMContentLoaded', () => {
      attemptAutoPlay();
    });

    // Also try when user interacts with the page
    document.addEventListener('click', () => {
      if (music.paused) {
        attemptAutoPlay();
      }
    }, { once: true });

    // ===== PAGE NAVIGATION =====
    function showSymptomAssessment() {
      document.getElementById('landing-page').classList.add('hidden');
      document.getElementById('symptom-modal').classList.remove('hidden');
    }

    // ===== SYMPTOM ASSESSMENT =====
    document.getElementById('submit-symptoms').addEventListener('click', function () {
      // Get symptom values
      const fever = parseInt(document.getElementById('sym-fever').value);
      const aggression = parseInt(document.getElementById('sym-aggression').value);
      const vision = parseInt(document.getElementById('sym-vision').value);
      const fungus = parseInt(document.getElementById('sym-fungus').value);
      const sector = document.getElementById('user-sector').value;

      // Calculate total infection (max 80)
      let infectionTotal = fever + aggression + vision + fungus;

      // Calculate health (100 - infectionTotal, min 20)
      let health = Math.max(20, 100 - infectionTotal);

      // Determine infection stage
      let stage = "UNINFECTED";
      if (infectionTotal > 60) stage = "BLOATER";
      else if (infectionTotal > 45) stage = "CLICKER";
      else if (infectionTotal > 25) stage = "STALKER";
      else if (infectionTotal > 10) stage = "RUNNER";

      // Calculate biometrics based on infection
      const bpSys = 120 + Math.floor(infectionTotal * 0.5);
      const bpDia = 80 + Math.floor(infectionTotal * 0.3);
      const sugar = 95 + Math.floor(infectionTotal * 0.8);
      const water = 75 - Math.floor(infectionTotal * 0.4);
      const heartRate = 72 + Math.floor(infectionTotal * 0.7);
      const oxygen = Math.max(85, 98 - Math.floor(infectionTotal * 0.3));

      // Store user data
      currentUser = {
        sector: sector,
        health: health,
        infectionStage: stage,
        infectionPercent: infectionTotal,
        medkits: 3,
        ammo: 24,
        rags: 8,
        alcohol: 5,
        cards: 12,
        bp: `${bpSys} / ${bpDia}`,
        sugar: sugar + " mg/dL",
        water: water + "%",
        heart: heartRate + " BPM",
        oxygen: oxygen + "%"
      };

      // Update UI
      updateCommandCenter();

      // Hide symptom modal and show command center
      document.getElementById('symptom-modal').classList.add('hidden');
      document.getElementById('command-center').classList.remove('hidden');

      // Hide the IST clock completely once medical assessment is complete
      document.getElementById('ist-clock').classList.add('hidden');
    });

    // ===== UPDATE COMMAND CENTER =====
    let currentUser = null;

    function updateCommandCenter() {
      if (!currentUser) return;

      // Update header
      document.getElementById('user-sector-display').textContent = currentUser.sector;
      document.getElementById('user-status').textContent = 'OPERATIVE';
      document.getElementById('infection-stage-display').textContent = currentUser.infectionStage;

      // Update health
      document.getElementById('health-pct').textContent = currentUser.health + '%';
      document.getElementById('health-bar').style.width = currentUser.health + '%';

      // Update infection details
      document.getElementById('infection-stage-detail').textContent = currentUser.infectionStage;
      document.getElementById('sector-detail').textContent = currentUser.sector.split(' - ')[0];

      // Update biometrics
      document.getElementById('bio-bp').textContent = currentUser.bp;
      document.getElementById('bio-infection').textContent = currentUser.infectionPercent + '%';
      document.getElementById('bio-sugar').textContent = currentUser.sugar;
      document.getElementById('bio-water').textContent = currentUser.water;
      document.getElementById('bio-heart').textContent = currentUser.heart;
      document.getElementById('bio-oxygen').textContent = currentUser.oxygen;

      // Update inventory
      document.getElementById('inv-medkits').textContent = currentUser.medkits;
      document.getElementById('inv-ammo').textContent = currentUser.ammo;
      document.getElementById('inv-rags').textContent = currentUser.rags;
      document.getElementById('inv-alcohol').textContent = currentUser.alcohol;
      document.getElementById('inv-cards').textContent = currentUser.cards;
    }

    // ===== MAP RENDERING =====
    function renderMap() {
      const markers = document.getElementById('markers-layer');
      markers.innerHTML = '';

      // Safe zones
      const safeZones = [
        { x: 25, y: 30, name: 'Medical Station' },
        { x: 70, y: 65, name: 'Supply Cache' },
        { x: 45, y: 80, name: 'Safe House' }
      ];

      // Danger zones
      const dangerZones = [
        { x: 40, y: 50, name: 'Infected Horde' },
        { x: 60, y: 70, name: 'Clicker Nest' },
        { x: 30, y: 75, name: 'Contaminated Zone' }
      ];

      safeZones.forEach(zone => {
        const m = document.createElement('div');
        m.className = 'zone-marker marker-safe';
        m.style.left = zone.x + '%';
        m.style.top = zone.y + '%';
        m.style.transform = 'translate(-50%, -50%)';
        m.innerHTML = 'üè•';
        m.title = zone.name;
        markers.appendChild(m);
      });

      dangerZones.forEach(zone => {
        const m = document.createElement('div');
        m.className = 'zone-marker marker-danger';
        m.style.left = zone.x + '%';
        m.style.top = zone.y + '%';
        m.style.transform = 'translate(-50%, -50%)';
        m.innerHTML = '‚ò†Ô∏è';
        m.title = zone.name;
        markers.appendChild(m);
      });

      // Add current position marker
      const pos = document.createElement('div');
      pos.className = 'zone-marker';
      pos.style.background = 'radial-gradient(circle, #ff3333, #8b0000)';
      pos.style.borderColor = '#ffffff';
      pos.style.left = '50%';
      pos.style.top = '50%';
      pos.style.transform = 'translate(-50%, -50%)';
      pos.innerHTML = 'üìç';
      pos.title = 'Your Position';
      markers.appendChild(pos);
    }

    // ===== INVENTORY MODAL =====
    const updateInvBtn = document.getElementById("update-inventory-btn");
    const inventoryModal = document.getElementById("inventory-modal");
    const saveInvBtn = document.getElementById("save-inventory-btn");
    const closeInvBtn = document.getElementById("close-inventory-btn");

    if (updateInvBtn) {
      updateInvBtn.addEventListener("click", () => {
        // Preload current values
        document.getElementById("inv-medkits-input").value = currentUser?.medkits || 3;
        document.getElementById("inv-ammo-input").value = currentUser?.ammo || 24;
        document.getElementById("inv-rags-input").value = currentUser?.rags || 8;
        document.getElementById("inv-alcohol-input").value = currentUser?.alcohol || 5;
        document.getElementById("inv-cards-input").value = currentUser?.cards || 12;

        inventoryModal.classList.remove("hidden");
      });
    }

    if (closeInvBtn) {
      closeInvBtn.addEventListener("click", () => {
        inventoryModal.classList.add("hidden");
      });
    }

    if (saveInvBtn) {
      saveInvBtn.addEventListener("click", () => {
        if (currentUser) {
          currentUser.medkits = parseInt(document.getElementById("inv-medkits-input").value) || 0;
          currentUser.ammo = parseInt(document.getElementById("inv-ammo-input").value) || 0;
          currentUser.rags = parseInt(document.getElementById("inv-rags-input").value) || 0;
          currentUser.alcohol = parseInt(document.getElementById("inv-alcohol-input").value) || 0;
          currentUser.cards = parseInt(document.getElementById("inv-cards-input").value) || 0;

          // Update UI
          document.getElementById('inv-medkits').textContent = currentUser.medkits;
          document.getElementById('inv-ammo').textContent = currentUser.ammo;
          document.getElementById('inv-rags').textContent = currentUser.rags;
          document.getElementById('inv-alcohol').textContent = currentUser.alcohol;
          document.getElementById('inv-cards').textContent = currentUser.cards;
        }
        inventoryModal.classList.add("hidden");
      });
    }

    // ===== LOGOUT =====
    document.getElementById('logout-btn').addEventListener('click', function () {
      currentUser = null;
      document.getElementById('command-center').classList.add('hidden');
      document.getElementById('landing-page').classList.remove('hidden');

      // Show the IST clock again when returning to landing page
      document.getElementById('ist-clock').classList.remove('hidden');

      // Reset symptom form
      document.getElementById('sym-fever').value = '0';
      document.getElementById('sym-aggression').value = '0';
      document.getElementById('sym-vision').value = '0';
      document.getElementById('sym-fungus').value = '0';
      document.getElementById('user-sector').value = 'Sector 1 - Downtown';
    });
  </script>
</body>

</html>